---
title: "ETC5521 Assignment 1"
subtitle: "Your title"
team: [FILL]
author:
  - [Aphiaut Imuan]
  - [FILL]
date: "`r Sys.Date()`"
output: 
  html_document
---

[This assignment is for ETC5521 Assignment 1 by Team `r rmarkdown::metadata$team` comprising of `r knitr::combine_words(rmarkdown::metadata$author)`.]{style="color:#006DAE;"}

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, 
                      message = FALSE, 
                      warning = FALSE)
library(tidyverse)
library(ggplot2)
library(knitr)
library(lubridate)
library(sf)
library(kableExtra)
library(broom)
library(readxl)
```

```{r, echo=FALSE}
investment <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-08-10/investment.csv')
chain_investment <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-08-10/chain_investment.csv')
ipd <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-08-10/ipd.csv')
gdplev <- read_excel("gdplev.xlsx", range = "A9:C101", 
    col_names = FALSE, col_types = c("numeric", 
        "numeric", "numeric"))
gdplev <- gdplev %>%
  rename("year" = ...1,
         "GDP_current" = ...2,
         "GDP_chain" = ...3)
```


# Introduction and motivation

[FILL] Give the bigger picture of the data, and inspire the reader to learn more about the problem by reading your analysis. 

Infrastructure investment is an important core of the country. It includes federal investments such as water suppliers and a private sector investment that manages electricity. It also includes the cost of research and development in technology.

Moreover, infrastructure investment plays a role in supporting both businesses and households. For example, the development of logistics has resulted in businesses reducing transportation costs. Households can access infrastructure services and can choose to use them. It also has a positive effect on both short-term and long-term economic growth [(Stupak, 2017)](https://ecommons.cornell.edu/bitstream/handle/1813/78289/CRS_Economic_Impact_of_Infrastructure_Investment_0717.pdf?sequence=1&isAllowed=y).

The above mentioned, the case study of infrastructure should be USA because the USA is a big country, has a large population, and people can access infrastructure services. Furthermore, the USA is also the world's largest economy. 

# Data description


The data comes from [Bureau of Economic Analysis](https://www.bea.gov/system/files/papers/BEA-WP2020-12.pdf). The raw .xlsx file is included, or can be downloaded directly from the [BEA Working paper series](https://www.bea.gov/system/files/2021-01/infrastructure-data-may-2020.xlsx).

The 3 primary data sets are already cleaned and saved as .csv files and they all have five variables. Of these, the four variables are the same as below.

```{r, echo=FALSE}
variable <- c("category","meta_cat","group_num","year")
class <- c("character","character","double","double")
description <- c("Category of investment",
                 "Group category of investment",
                 "Group number of investment",
                 "Year of investment")
e.g. <- c("Private,Federal...","Total infrastructure,Water supply,GDP...","1,2,3...","1947,1948,1949...")
dic<- data.frame(variable, class,description, e.g.)

kable(dic,
      align = "llll","pipe")
```

The 3 data sets record the gross investment, chained investment in millions of USD and Implicit Price Deflators (IPDs) respectively.

```{r, echo=FALSE}
variable <- c("gross_inv","gross_inv_chain","gross_inv_ipd")
class <- c("double","double","double")
description <- c("Gross investment in millions of USD",
                 "Gross investment (chained 2021 dollars) in millions of USD",
                 "Implicit Price Deflators (IPDs) An implicit price deflator is the ratio of the current-dollar value of a series, such as gross domestic product (GDP), to its corresponding chained-dollar value, multiplied by 100.")
dic2 <- data.frame(variable,class,description) 

kable(dic2,
      align = "lll","pipe")
typeof(gdplev$year)
```

The gdplev data set is downloaded from [Bureau of Economic Analysis](https://www.bea.gov/data/gdp/gross-domestic-product), which is a supplementary data set for our analysis. It records the current GDP and chain GDP in US from 1929 to 2021. Its variable contains year, GDP_current and GDP_chain whose type is all double.

- Chained dollars: Chained dollars is a method of adjusting real dollar amounts for inflation over time, to allow the comparison of figures from different years. The U.S. Department of Commerce introduced the chained-dollar measure in 1996.

# Questions of interest

[FILL] What questions might be possible to answer with this data, aiming for about 20. Bold the 3-4 questions you will address in the 

1. What category of investment is the highest average gross investment and Chain? Does it same?

2. What is the trend of total basic infrastructure?

3. what is the trend of total social infrastructure?

4. What year and category are the highest investment and Chain?

5. What year and category are the lowest investment and Chain?

**6. What is the relationship between total digital investment and gdp?** (download gdp from other and join it later)

7. What are the highest investment between Air, Water, Rail transportation investment ?

8. What are the similarities/difference of trend between Federal electric power structures investment and Private electric power structures investment?

9. How does the digital investment change? (ipd) it will show the changing of price base on based year (2012)

10. How does the transportation investment change? (ipd) it will show the changing of price base on based year (2012)

11. How does the power investment change? (ipd) it will show the changing of price base on based year (2012)

12. What is the proportion of total social investment in all category infrastructure?

13. What is the proportion of total basic infrastructure investment in all category infrastructure?

14. **How does changing of basic infrastructure investment (million dollar) similar/different with Implicit Price Deflators  (IPDs) of basic infrastructure investment?**

15. What are the trends in all categories infrastructure investment so far?

16. In 2012, what is the proportion of various investments in the total investment？

17. What category of investment has the greatest impact on GDP and how?

18. **What is the relationship between GDP and private investment, federal investment？And which one is stronger impact on GDP?**

19. What is the proportion of total digital investment in all category infrastructure?

20. **Is there a linear relationship between GDP and total basic infrastructure investment? Positive or negative?**

# Expected findings

[FILL] For your chosen questions explain what you think you might find.

In question 6: We expect the positive relationship between total data investment and GDP. Moreover we expect to see the steep line from 1900 to 2017.

In question 14: We expect the results should be the same or slightly difference.

In question 18: We expect the strong relation between GDP and federal investment.

In question 20: We expect there is a positive linear relationship between GDP and total basic. infrastructure investment.

# Analysis and findings

[FILL] Should include at least one plot or numerical summary for each of your questions, that helps the reader arrive at an answer. You should also write paragraphs describing the methods, summaries and findings. 

What is the relationship between total digital investment and gdp?*

```{r}
investment <- investment %>%
  left_join(gdplev, by = "year")
chain_investment <- chain_investment %>%
  left_join(gdplev, by = "year")
```

```{r}
q6 <- investment %>%
  filter(category == "Total digital infrastructure")
  
q6_lm <-  lm(GDP_current ~ gross_inv, data = q6)
  
 ggplot(q6,
       aes(x = gross_inv,
           y = GDP_current)) +
  geom_point(alpha = 0.2) +
  geom_smooth(method = "lm")
q6_lm_summary <- glance(q6_lm)
q6_lm_summary
tidy(q6_lm)
```




# References
